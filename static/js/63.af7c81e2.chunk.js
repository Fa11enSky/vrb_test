"use strict";(self.webpackChunkvrb_test=self.webpackChunkvrb_test||[]).push([[63],{4696:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(5043),i=s(579);const n=e=>{let{children:t,close:s}=e;return(0,a.useEffect)((()=>{const e=e=>{"Escape"===e.code&&s()};return document.querySelector("body").classList.add("lock"),window.addEventListener("keydown",e),()=>{document.querySelector("body").classList.remove("lock"),window.removeEventListener("keydown",e)}}),[s]),(0,i.jsx)("div",{onClick:e=>{e.currentTarget===e.target&&s()},style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#00000065",overflowY:"auto",zIndex:900},children:t})}},2450:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(7950);const i=e=>{let{children:t}=e;const s=document.getElementById("modal-root");return a.createPortal(t,s)}},2026:(e,t,s)=>{s.d(t,{A:()=>I});var a=s(5043);const i="styles_movieItem__FEOj+",n="styles_optList__caSlT",r="styles_optBtn__z9Cnp",l="styles_optIcon__5ZOfg",c="styles_title__nG37w",o="styles_thumb__PJomn",d="styles_date__Ot7V6",u="styles_rating__KqpNa",m="styles_favorite__vQzuy";var p=s(5394),x=s(5051),h=s(6720),_=s(184),j=s(4180),g=s(3216);const y="styles_formEdit__wT9Da",v="styles_formTitle__L7ENl",f="styles_imageLabel__2iBzb",b="styles_plus__L01mA",w="styles_imageInput__+gI8C",N="styles_smbBtn__dCi73";var C=s(9955),k=s(7154);const A=async(e,t)=>{const{data:s}=await k.A.put("/films/".concat(t),e);return s};var S=s(3726),L=s(579);const E=e=>{let{movie:t,close:s}=e;const[i,n]=(0,a.useState)(t.title),[r,l]=(0,a.useState)(t.director),[c,o]=(0,a.useState)(t.actors.join(",")),[d,u]=(0,a.useState)(t.image),[m,p]=(0,a.useState)(t.release_date),[h,_]=(0,a.useState)(t.rating.toString()),[g,k]=(0,a.useState)(t.description),{movies:E,setMovies:D,favorites:Y,setFavorites:R}=(0,j.Y)(),F=(0,a.useRef)(null),I=e=>{const{name:t,value:s}=e.target;switch(t){case"title":n(s);break;case"director":l(s);break;case"actors":o(s);break;case"date":p(s);break;case"rating":_(s);break;case"description":k(s)}};return(0,L.jsxs)("form",{className:y,onSubmit:async e=>{e.preventDefault();const a={title:i.trim(),director:r.trim(),actors:c.split(","),image:d,release_date:m,rating:h,description:g.trim()};if(d!==t.image){const e=F.current.files[0],t=await(0,C.A)(e);a.image=t}try{const e=await A(a,t._id),i=E.findIndex((t=>t._id===e._id)),n=[...E];n.splice(i,1,e),D(n);const r=Y.findIndex((t=>t._id===e._id));if(-1!==r){const t=[...Y];t.splice(r,1,e),R(t)}S.Notify.success("Movie updated successfully"),s()}catch(n){S.Notify.failure(e.message)}},children:[(0,L.jsx)("p",{className:v,children:" Edit movie data"}),(0,L.jsxs)("label",{className:f,htmlFor:"image",children:[(0,L.jsx)("img",{src:d||t.image,alt:"poster",width:100}),(0,L.jsx)(x.pi5,{className:b}),(0,L.jsx)("input",{ref:F,className:w,type:"file",name:"image",id:"image",accept:"image/*",onChange:e=>{const t=e.target.files[0];t&&u(URL.createObjectURL(t))}})]}),(0,L.jsxs)("label",{children:["Title",(0,L.jsx)("input",{onChange:I,type:"text",name:"title",id:"title",value:i})]}),(0,L.jsxs)("label",{children:["Rating (1.0...10)",(0,L.jsx)("input",{onChange:I,type:"string",name:"rating",id:"rating",value:h,pattern:"[0-9]{1,2}(\\.[0-9]{1,2})?"})]}),(0,L.jsxs)("label",{children:["Director",(0,L.jsx)("input",{onChange:I,type:"text",name:"director",id:"director",value:r})]}),(0,L.jsxs)("label",{children:["Actors"," ",(0,L.jsx)("input",{onChange:I,type:"text",name:"actors",id:"actors",value:c})]}),(0,L.jsxs)("label",{children:["Release date (YYYY-MM-DD)",(0,L.jsx)("input",{onChange:I,type:"text",name:"date",id:"date",value:m,pattern:"\\d{4}-\\d{2}-\\d{2}"})]}),(0,L.jsxs)("label",{children:["Description",(0,L.jsx)("textarea",{onChange:I,type:"text",name:"description",id:"description",value:g})]}),(0,L.jsx)("button",{className:N,type:"submit",children:"Edit"})]})};var D=s(2450),Y=s(4696);const R=e=>{let{item:t}=e;const[s,y]=(0,a.useState)(!1),{_id:v,title:f,image:b,release_date:w,rating:N}=t,{toggleFavorites:C,permanentDelete:k,favorites:A}=(0,j.Y)(),S=(0,g.Zp)(),R=()=>{y(!s)},F=A.map((e=>e._id)).includes(v);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("li",{onClick:e=>{const{target:t}=e;"BUTTON"!==t.nodeName&&S("/details/".concat(v))},className:i,children:[(0,L.jsxs)("ul",{className:n,children:[(0,L.jsx)("li",{children:(0,L.jsx)("button",{onClick:()=>{C(t)},className:r,children:(0,L.jsx)(p.L4$,{className:"".concat(l," ").concat(F?m:"")})})}),(0,L.jsx)("li",{children:(0,L.jsx)("button",{onClick:()=>{k(v)},className:r,children:(0,L.jsx)(_.H8h,{className:l})})}),(0,L.jsx)("li",{children:(0,L.jsx)("button",{onClick:R,className:r,children:(0,L.jsx)(_.F7,{className:l})})})]}),(0,L.jsx)("div",{className:o,children:(0,L.jsx)("img",{src:b||"https://t3.ftcdn.net/jpg/04/60/01/36/360_F_460013622_6xF8uN6ubMvLx0tAJECBHfKPoNOR5cRa.jpg",alt:"".concat(f," poster")})}),(0,L.jsx)("h2",{className:c,children:f}),(0,L.jsxs)("span",{className:d,children:[(0,L.jsx)(h.Hvs,{}),(0,L.jsx)("span",{children:w})]}),(0,L.jsxs)("span",{className:u,children:[(0,L.jsx)(x.Vis,{}),(0,L.jsx)("span",{children:N})]})]}),s&&(0,L.jsx)(D.A,{children:(0,L.jsx)(Y.A,{close:R,children:(0,L.jsx)(E,{movie:t,close:R})})})]})},F="styles_movieList__+plJB",I=e=>{let{data:t}=e;return(0,L.jsx)("ul",{className:F,children:t.map((e=>(0,L.jsx)(R,{item:e},e._id)))})}},9063:(e,t,s)=>{s.r(t),s.d(t,{default:()=>A});var a=s(5043),i=s(7154);i.A.defaults.baseURL="https://65fa44ea3909a9a65b1a17dd.mockapi.io/api/v1/";const n=async()=>{try{const{data:e}=await i.A.get("films");return e}catch(e){throw new Error(e.message)}};var r=s(2026);const l="styles_inputWrapper__0aIgK";var c=s(579);const o=e=>{let{setQuery:t}=e;return(0,c.jsx)("label",{className:l,children:(0,c.jsx)("input",{onChange:e=>{t(e.target.value)},type:"text"})})},d=(e,t)=>t.filter((t=>t.title.toLowerCase().includes(e.trim().toLowerCase())));var u=s(4180),m=s(2450),p=s(4696);const x="styles_formAdd__-rY0k",h="styles_formTitle__6ug4I",_="styles_imageLabel__iQvi-",j="styles_plus__DQUA7",g="styles_imageInput__iY-wC",y="styles_smbBtn__vsA6o";var v=s(5051),f=s(9955);const b=async e=>{const{data:t}=await i.A.post("/films",e);return t};var w=s(3726);const N=e=>{let{close:t}=e;const{movies:s,setMovies:i}=(0,u.Y)(),[n,r]=(0,a.useState)(""),[l,o]=(0,a.useState)(""),[d,m]=(0,a.useState)(""),[p,N]=(0,a.useState)(""),[C,k]=(0,a.useState)(""),[A,S]=(0,a.useState)(""),[L,E]=(0,a.useState)(""),D=(0,a.useRef)(null),Y=e=>{const{name:t,value:s}=e.target;switch(t){case"title":r(s);break;case"director":o(s);break;case"actors":m(s);break;case"date":k(s);break;case"rating":S(s);break;case"description":E(s)}};return(0,c.jsxs)("form",{className:x,onSubmit:async e=>{if(e.preventDefault(),!n||!l||!d.trim()||!C||!A||!L)return void w.Notify.failure("All fields is required");const a={title:n.trim(),director:l.trim(),actors:d.split(","),image:p,release_date:C,rating:A,description:L.trim()};if(p){const e=D.current.files[0],t=await(0,f.A)(e);a.image=t}try{const e=await b(a),n=[...s,e];i(n),t(),w.Notify.success("Movie added successfully")}catch(e){w.Notify.failure(e.message)}},children:[(0,c.jsx)("p",{className:h,children:" Add movie"}),(0,c.jsxs)("label",{className:_,htmlFor:"image",children:[p?(0,c.jsx)("img",{src:p,alt:"poster",width:100}):(0,c.jsx)("div",{children:"POSTER"}),(0,c.jsx)(v.pi5,{className:j}),(0,c.jsx)("input",{ref:D,className:g,type:"file",name:"image",id:"image",accept:"image/*",onChange:e=>{const t=e.target.files[0];t&&N(URL.createObjectURL(t))}})]}),(0,c.jsxs)("label",{children:["Title",(0,c.jsx)("input",{onChange:Y,type:"text",name:"title",id:"title",value:n})]}),(0,c.jsxs)("label",{children:["Rating (1.0...10)",(0,c.jsx)("input",{onChange:Y,type:"string",name:"rating",id:"rating",value:A,pattern:"[0-9]{1,2}(\\.[0-9]{1,2})?"})]}),(0,c.jsxs)("label",{children:["Director",(0,c.jsx)("input",{onChange:Y,type:"text",name:"director",id:"director",value:l})]}),(0,c.jsxs)("label",{children:["Actors"," ",(0,c.jsx)("input",{onChange:Y,type:"text",name:"actors",id:"actors",value:d})]}),(0,c.jsxs)("label",{children:["Release date (YYYY-MM-DD)",(0,c.jsx)("input",{onChange:Y,type:"text",name:"date",id:"date",value:C,pattern:"\\d{4}-\\d{2}-\\d{2}"})]}),(0,c.jsxs)("label",{children:["Description",(0,c.jsx)("textarea",{onChange:Y,type:"text",name:"description",id:"description",value:L})]}),(0,c.jsx)("button",{className:y,type:"submit",children:"Add"})]})},C="styles_addBtn__dD06h",k=()=>{const[e,t]=(0,a.useState)(!1),s=()=>{t(!e)};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{className:C,onClick:s,children:"Add new movie"}),e&&(0,c.jsx)(m.A,{children:(0,c.jsx)(p.A,{close:s,children:(0,c.jsx)(N,{close:s})})})]})},A=()=>{const{movies:e,setMovies:t}=(0,u.Y)(),[s,i]=(0,a.useState)("");return(0,a.useEffect)((()=>{n().then((e=>t(e))).catch((e=>w.Notify.failure(e.message)))}),[]),(0,c.jsxs)("section",{children:[(0,c.jsxs)("div",{children:[" ",(0,c.jsx)(o,{setQuery:i})," ",(0,c.jsx)(k,{})]}),(0,c.jsx)(r.A,{data:s?d(s,e):e})]})}},9955:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(3712);const i=new(s.n(a)().Cloudinary)({cloud_name:"dtsw0uqfz"}),n=async e=>{try{const t=new FormData;t.append("file",e),t.append("upload_preset","ftw0ehjd");const s=await fetch("https://api.cloudinary.com/v1_1/".concat(i.config().cloud_name,"/upload"),{method:"POST",body:t});if(!s.ok)throw new Error("Failed to upload image");return(await s.json()).secure_url}catch(t){throw console.error("Error uploading image to Cloudinary:",t),t}}}}]);
//# sourceMappingURL=63.af7c81e2.chunk.js.map